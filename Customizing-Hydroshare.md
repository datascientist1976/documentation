Hydroshare is a Django project. This document is part of the [Hydroshare Developers' Guide](https://github.com/hydroshare/hydroshare2/wiki/Hydroshare-Developers'-Guide).

# Getting a working copy of Hydroshare to extend
We are currently using Docker to make getting Hydroshare as simple as possible. You can follow the [[Developing with PyCharm Professional and the pre built virtual machine]] guide.

Alternately, you can of course get Hydroshare through the GitHub repository. You will need to get the latest version of the code. Do a git pull in the Hydroshare directory, or see the document [How to Push/Pull in GitHub](https://github.com/hydroshare/hydroshare2/raw/master/docs/How%20To%20Push-Pull%20Changes%20in%20GitHub.pdf) for more detailed instructions.

## Hydroshare project structure 
_git clone https://github.com/hydroshare/hydroshare2_

After following the steps above, you'll get something like this:

    hydroshare/__init__.py        # empty.
    hydroshare/settings.py        # project level settings. lead developers only.
    hydroshare/local_settings.py  # override settings for your project here.
    hydroshare/requirements.txt   # autogenerated by pip, library dependencies.
    hydroshare/uwsgi.py           # do not modify. webserver interface.
    hydroshare/urls.py            # url mappings. see tutorial.
    hydroshare/celeryworker.py    # do not modify. task queue definition.
    hydroshare/hs_core/*          # hydroshare core services.
    hydroshare/hs_apps/*          # hydroshare apps go here. (you may need to mkdir this directory)
    hydroshare/ga_resources/      # geoanalytics core.
    hydroshare/ga_applications/	  # geoanalytics core.
    hydroshare/ga_ows/            # geoanalytics core.
    hydroshare/ga_irods/          # django IRODS interface.
    hydroshare/ga_interactive/    # django-IPython Notebook int. (experimental)

All of your code goes in the `hs_apps/` directory inside of this. Change to this directory and then proceed to the next section. Note: It may be necessary to add a blank `__init__.py` and `models.py` files to the `hs_apps/` directory. 

# Working on your own Hydroshare extension

Extending this core will involve creating a new Hydroshare app. Please note that creating a new Hydroshare app will create a new "Git submodule" and that this submodule is tracked separately by Git.

We have a template for Hydroshare apps in GitHub:

* Fork the [hs_app_template](https://github.com/hydroshare/hs_app_template).
* Rename the newly created repository to the name of your hydrosphere app, e.g. my_hs_app.

**On your local machine:**

* Clone the app repository in to your Hydroshare project under the `hydroshare/hs_apps/` directory. This will result in a new directory in your machine with the same name as the repository. This is your new Hydroshare "app name"
* Rename `hydroshare/hs_apps/templates/pages/genericresource.html` to `resource.html`. This needs to be done to view hydroshare resources regardless of type
* Create an `__init__.py` file in the `hydroshare/hs_apps` directory.  This file should be empty (e.g. `touch __init__.py`)
* Open `hydroshare/settings.py` and add the Hydroshare "app name" to the list of INSTALLED_APPS, like so:

    `INSTALLED_APPS = (
    ...
    "dublincore",
    "hs_core",
    "hs.app_name",
    )`

*  If remotely developing in PyCharm, sync the entire hs_apps directory with the server: Right click on `/hydroshare/hs_apps` and select "Upload to localhost_1338"

Now that you have added the app, Hydroshare recognizes it as a new application.  You are essentially off and running at this point.  From here, depending on what your extension does, you may want to:
* [Add new resource types or other objects that persist in the Hydroshare database](Add-new-resource-types-or-other-objects-that-persist-in-the-Hydroshare-database)
* [Add web API endpoints meant to allow other applications to work with your extensions](Adding-an-API)
* [Add web application endpoints for users to interact with in their browser](Adding-WebApp-Endpoints)
* [Add long-running tasks that may run on different machines or in the background](Adding-Tasks)
* [Add automated tests that ensure your functionality runs properly](Adding-Tests)

## Hydroshare app template structure

git clone https://github.com/hydroshare/hs_app_template

    hs_app/__init__.py         # utility or broad functions.
    hs_app/models.py           # database interface.
    hs_app/views.py            # website interface.
    hs_app/urls.py             # url-to-view endpoint mapping.
    hs_app/api.py              # api interface.
    hs_app/tasks.py            # deferred application tasks.
    hs_app/admin.py            # registrations of models into the admin interface.
    hs_app/tests.py            # automatic tests.  
    hs_app/static/hs_app/js/   # application specific javascript libraries.
    hs_app/static/hs_app/css/  # application specific CSS libraries.
    hs_app/templates/includes  # template includes.
    hs_app/templates/hs_app    # application specific templates.
    hs_app/templates/pages     # automatically discovered page rendering.
    requirements.txt           # application specific library requirements. automatically generate with pip freeze

## Contributing back to Hydroshare 

When updating your project and pushing it to the dev branch, please send a note to [Jeff Heard](https://github.com/JeffHeard) to get it into the [Hydroshare Development site](http://dev.hydroshare.org/). Then the latest version of your module will be committed to the Hydroshare master repository.